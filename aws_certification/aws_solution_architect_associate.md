- AWS Wavelength
  - 5Gネットワーク通信プロバイダのデータセンターにAWSサービスを使用したバックエンドサービスを構築できる

- EC2 Image Builder
  - 自動でセキュリティパッチの適用などを、AMIを繰り返し作成できる

- EC2 メタデータ
  - EC2インスタンス内から以下のURLで取得できる
    - <http://169.254.169.254/latest/meta-data/>

- Compute Optimizerで直近14日間のCPU使用率などのメトリクスを分析して、レコメンデーションをレポートしてくれる

- S3
  - バケットに保存したオブジェクトは自動的に3つ以上のAZにレプリケーションされる。
  - オブジェクトのサイズ制限は5TB
  - 5500req/sのGETリクエストが可能
  - 1つのオブジェクトのサイズが大きい場合(100MB以上)は、マルチパートアップロードを検討する
    - マルチパートアップロードは、ファイルを複数のパートに分けてS3に並列でアップロードする手法。
    - 帯域を無駄なく使用でき、一部パートが失敗しても失敗したもののみをリトライできる。
  - S3 Transfer Acceleration
    - 設定したバケットのリージョンから遠く離れた土地からアップロードされる場合に、Transfer Accelerationを有効にすることで新しくエンドポイントが提供される。これを使うことで各地のエッジロケーションを入り口に、リージョンまではAWSのグローバルネットワークが使用されて、ネットワークパフォーマンスが安定する。
  - オブジェクト保護
    - オブジェクトにバージョニングを持たせられる
    - MFA Delete
      - MFA認証で削除する
    - オブジェクトロック
      - オブジェクトロックを設定したオブジェクトは保持期日中に、DeleteObjectVersionができない。
      - ガバナンスモード
        - 指定した保持期日中はバージョンを指定した削除ができない。
        - 権限があるIAMユーザー(s3:BypassGovernanceRetention)はオブジェクトロックを解除できる。
      - コンプライアンスモード
        - ルートユーザーであっても解除ができない
      - リーガルホールド
        - 保持期日を指定しない。
        - s3:PutObjectLegalHoldがあるユーザーはリーガルホールドを無効にできる。
    - レプリケーション
      - S3バケット同士で設定できる
      - 送信元、送信先のバケットでバージョン人具を有効にする必要がある
      - クロスリージョン可能
  - セキュリティ
    - ACL(Access Control List)
      - バケットやオブジェクトに対して設定できるアクセス権限の設定。
      - 無効化可能。
      - 現在はACL無効化が推奨されている。
        - オブジェクトごとに個別アクセスを制御する必要がある異常な状態を除く。
    - バケットポリシー
      - バケットのリソースベースのポリシー。
      - 特定IP以外からのリクエストを拒否したりできる。
    - アクセスポイント
      - 複数アプリから違う手段で同じバケットにアクセスする場合、複雑性が増してしまう。
      - アクセスポイントを使うことで、アクセスポイントポリシーをアクセスポイントごとに設定できる
        - 複数のリクエスト元の条件をすべて満たすバケットポリシーを作る必要がなくなり、個別のアクセスポイントポリシーを編集することで対応できる。
    - ブロックパブリックアクセス
      - ACL、バケットポリシー、新規、既存それぞれにある。
      - バケット個別と、アカウント全体に対して設定できる。
    - 署名付きURL
      - 特定の匿名ユーザーだけにアクセス権限を与えたい場合に使う
    - 暗号化
      - クライアントサイド暗号化
        - S3アップロード前に暗号化する
        - 暗号化キーはオンプレミスキーやKMSキーなど自由に選択できる
      - サーバーサイド暗号化
        - S3アップロード後にオブジェクト保存する際に暗号化される
        - SSE-S3
          - Server Side Encrypt S3
          - S3が管理しているキーで暗号化する
          - s3:GetObjectで復号できる
        - SSE-KMS
          - Server Side Encrypt Key Management Store
          - KMSでユーザーが作成・管理しているCMK(Customer Master Key)を使用してS3が暗号化する
          - CMKはローテーションや無効化・削除ができる。
          - s3:GetObjectとkms:Decryptで復号できる
        - SSE-C
          - オンプレミスで生成したキーを使用してS3が暗号化する
          - AWSに暗号化キーを保存したくないケースで要件を満たす

  - 料金
    - ストレージ料金
    - リクエスト料金
    - データ転送料金
      - インターネットからの転送受信、同一リージョン内のAWSサービスとのやり取り、CloudFrontに転送されるデータ転送には料金が発生しない
      - インターネットや別リージョンのようなリージョン外へのアウト転送に料金が発生する
      - クロスリージョンレプリケーションでもデータ転送料金が発生する
    - ストレージクラス
      - オブジェクトをアップロードするときに選択できる
      - アップロード済みのオブジェクトも変更できる
      - ライフサイクル
        - ライフサイクルルールによって、オブジェクトが作成されてからの日数によって自動でストレージクラスを移動させられる
        - 公開期間が90日と決まっているとしたとき、公開期間が終了した後も1年間は保存する必要がある場合、作成後90日経過したオブジェクトを自動でGlacier Flexible Retrievalに移動され、365日経過したオブジェクトを自動で削除する
        - バージョニングを有効にしている場合は非現行バージョンのストレージクラス移動や削除が可能
          - 移動や削除せずに保持しておくバージョン数も指定できる
        - S3 Intelligent Tiering
          - アクセスパターンが全く予想できない場合はライフサイクルルールを指定できない
          - デフォルトで3階層あり、オプションで5階層ある
            - デフォルト
              - 高頻度アクセスティア
              - 低頻度アクセスティア
              - アーカイブインスタントアクセスティア
            - オプション
              - アーカイブアクセスティア
              - ディープアーカイブアクセスティア
          - アクセス実績によって自動的に保存するティアを自動で移動してくれて、コストを最適化する
          - アクセスすると高頻度アクセスティアに戻るのでリクエスト料金は同じ
          - オブジェクト1000件当たりのモニタリング月額料金が発生する
          - オプションのアーカイブアクセスティアでは5時間、ディープアーカイブアクセスティアは12時間の取り出し時間が発生する
    - リクエスタ支払い
      - リクエストしたAWSアカウントに請求されるようにできる

- EBS
  - EC2にアタッチして使用するブロックストレージ
  - EC2インスタンスストア
    - ほとんどはEBSボリュームのみ使用できるが、特定のインスタンスタイプではEC2インスタンスストアが利用できる
    - インスタンスストアはEC2インスタンスが起動しているハードウェアホストのローカル領域をEC2にアタッチして使用する
    - 料金はEC2インスタンスの使用料金に含まれる
    - EC2インスタンスを停止、終了したときにデータは削除される
    - EBSよりも最大IOPSが高い
  - ボリュームの種類
    - 汎用SSD
    - プロビジョンドIOPS SSD
      - 高いパフォーマンスが必要なケース
      - 指定したIOPS価に応じて追加料金が発生する
    - スループット最適化HDD
      - 2つ目以降のボリュームとしてHDDが選択できる
      - 大容量のデータやシーケンシャルなアクセスを必要とする場合に最適
    - コールドHDD
      - スループット最適化HDDよりも低コスト
      - コスト重視したいときに使う
  - 暗号化
    - KMSのAWS管理キー、CMK(Customer Management Key)を選択できる
    - スナップショットも暗号化されている
  - スナップショット
    - EBSボリュームはAZにある
    - AZ内でレプリケートされている
    - AZ全体で障害が発生したときはEBSボリュームへアクセスできない
    - スナップショットはS3に保存されるので、リージョンの複数のAZが使用される
      - 1つのAZに障害が発生しても復元が可能
    - Data Lifecycle Mangerでスナップショットの作成を自動化できる

- EFS(Elastic File System)
  - 複数のEC2 Linuxのインスタンスからマウントして使用できる
  - S3のようにIAや1ゾーンストレージがある
- FSx for WindowsFileServer
  - EFSはWindowsに対応していないので、Windowsの場合はこれを使う
  - SMBプロトコルをサポートしているのでLinuxサーバーからもアクセスできる
- FSx for Lustre
  - Linuxから共有できるファイルシステム
  - ハイパフォーマンスコンピューティング(HPC)や機械学習などの大量データの高速処理を必要とするケースに最適

- Snow
  - 物理デバイスを指定したデータセンターなどに届けて、ローカルでデータをコピーできる
  - Snowcone, Snowball, Snowmobile

- Storage Gateway
  - オンプレミスからの通常のファイル保存操作により、S3などのAWSのストレージに自動でファイルを保存できる
  - AWS側のサービスと連携する仮想マシンをマネジメントコンソールからダウンロードして、オンプレミスにデプロイする
  - デフォルトはインターネットを介した通信だが、VPCエンドポイントを使用することでVPN接続やDirectConnectでの接続も可能
  - タイプ
    - ファイルゲートウェイ
      - NFSかSMBプロトコルでオンプレミスのアプリケーションサーバーからデータを保存すると、S3バケットへデータがコピーされる
    - ボリュームゲートウェイ
      - iSCSIプロトコルでオンプレミスのアプリケーションサーバーからデータを保存すると、ボリュームゲートウェイのボリュームへデータがコピーされる
      - 保管型ボリュームとキャッシュボリュームがある
      - 保管型
        - オンプレミスにすべてのデータを保持しながら、非同期でAWSにバックアップ
      - キャッシュ
        - 頻繁にアクセスされるデータのみオンプレミスに保持して、すべてのデータをAWSのみに保存
    - テープゲートウェイ
      - 仮想テープライブラリをサポートするソフトウェアから使用できる
      - オンプレミスのテープデバイス装置のように使用でき、S3Glacier Flexible RetrievalやDeep Archiveに保存できる

- AWS DataSync
  - オンプレミスのデータをS3、EFS、FSxへ安全、高速に転送するサービス
  - データの転送はDataSyncエージェントがスケジュールにより定期実行する
  - 送信中のデータを暗号化して、整合性チェックが実行される
  - 送信元はNFS、SMB、HDFSをサポートしている
  - 送信元としてオンプレミスだけでなく、S３、EFS、FSxなどのAWSサービスもサポートしているので、AWSサービス同士のデータ転送にも使用できる
  - デフォルトではインターネットを介した通信だが、VPCエンドポイントを使用することでVPN接続やDirect Connectでの接続が可能。

- AWS Transfer Family
  - オンプレミスからSFTP、FTPS、FTPを使って、S3、EFSにアップロードダウンロードできる

- VPC
  - プライベートなネットワーク環境を構築できる
  - リージョンを選択してVPCを作成する
    - IPV4アドレスの範囲をCIDRで指定する
      - `10.0.0.0/16`は`10.0.0.0`から`10.0.255.255`が範囲になる
    - プライベートなネットワークなので、同一のプライベートIPアドレスを複数のVPCで使用することができる
      - 本番環境とテスト環境とでアプリケーションのネットワークを分離できる
  - インターネットゲートウェイ
    - リージョンに作成してVPCにアタッチすることで、インターネットへのネットワークの出入り口として動作する
    - 内部に複数のノードがあり、冗長性、可用性を機能として提供している
      - 通過するネットワークが増えてもノードが増えて水平スケーリングするので帯域幅の制限はない
    - データセンター、アウトバウンドのみ通信、AWSサービス、他VPCなどにはそれぞれ専用のゲートウェイサービスがある
  - サブネット
    - VPCのIPアドレス範囲を、サブネットでさらに範囲指定する
    - AZを指定して作成する
  - ルートテーブル
    - サブネットから送信先IPアドレスごとのネットワークターゲットを設定する
    - VPCを作成するとメインルートテーブルというデフォルトのルートテーブルが作成される
      - VPCのIPアドレス範囲がlocalをターゲットとした送信先に指定されている
    - 新たに作成したサブネットは自動でメインルートテーブルに関連付けられる
      - なのでサブネット同士の接続がデフォルトで可能になる
    - パブリックサブネット
      - インターネットへ向けて送受信する場合は、ルートテーブルのルートの送信先に`0.0.0.0/0`、ターゲットにインターネットゲートウェイのIDを設定する
      - このルートテーブルをかんれづけたサブネットをパブリックサブネットと呼ぶ
      - パブリックサブネットで起動したEC2インスタンスなどにパブリックIPアドレスを有効化すると、インターネットから直接アクセスできる
    - プライベートサブネット
      - インターネットゲートウェイに対してルートを持たないサブネットをプライベートサブネットと呼ぶ
  - NATゲートウェイ
    - TODO

P139
